# Задание 2: Функции, модульные тесты

import math

def take_input():
    '''
    Запрашивает у пользователя шесть параметров и проверяет их корректность.

    @requires: Пользователь взаимодействует с программой через консоль.
    @modifies: Ничего.
    @effects: Возвращает кортеж из шести значений, введённых пользователем.
    @raises: ValueError, если введённые данные некорректны - введено нечисловое значение.
    @returns: tuple[d1, d2, h, v_sand, n, theta1], где:
              - d1 (float): кратчайшее расстояние от спасателя до кромки воды в ярдах,
              - d2 (float): кратчайшее расстояние от утопающего до берега в футах,
              - h (float): боковое смещение между спасателем и утопающим в ярдах,
              - v_sand (float): скорость движения спасателя по песку в милях/ч,
              - n (float): коэффициент замедления спасателя при движении в воде,
              - theta1 (float): направление движения спасателя по песку в градусах.
    '''    
    while True:
        try:
            d1 = float(input('Введите кратчайшее расстояние от спасателя до кромки воды в ярдах: '))
            if d1 <= 0 :
                print("Расстояние не может быть равно нулю или меньше. Повторите ввод.")
                continue
            d2 = float(input('Введите кратчайшее расстояние от утопающего до берега в футах: '))
            if d2 <= 0 :
                print("Расстояние не может быть равно нулю или меньше. Повторите ввод.")
                continue
            h = float(input('Введите боковое смещение между спасателем и утопающим в ярдах: '))
            if h <= 0 :
                print("Расстояние не может быть равно нулю или меньше. Повторите ввод.")
                continue
            v_sand = float(input('Введите скорость движения спасателя по песку в милях в час: '))
            if v_sand <= 0:
                print("Скорость не может быть равной нулю или меньше. Повторите ввод.")
                continue
            n = float(input('Введите коэффициент замедления спасателя при движении в воде: '))
            if n < 0:
                print("Коэффициент не может быть отрицательным. Повторите ввод.")
                continue
            theta1 = float(input('Направление движения спасателя по песку в градусах: '))
            if theta1 < 0 or theta1 > 360:
                print("Угол должен быть в пределах от 0 до 360 градусов.Повторите ввод.")
                continue
            break
        except ValueError:
            print("Некорректный ввод. Вводите только числа.")      
            
    return d1, d2, h, v_sand, n, theta1

def find_x(d1, theta1, yard_to_foot=3):
    '''
    Вычисляет расстоние от спасателя до кромки воды под прямым углом.

    @param d1 (float): Расстояние от спасателя до кромки воды в ярдах.
    @param theta1 (float): Угол направления движения спасателя по песку в градусах.
    @param yard_to_foot (float): Коэффициент перевода ярдов в футы.
    @requires: Все параметры заданы и имеют правильные типы.
    @modifies: Ничего.
    @effects: Возвращает одно вещественное число.
    @returns: float: Расстоние от спасателя до кромки воды под прямым углом x.
    '''
    x = yard_to_foot * d1 * math.tan(math.radians(theta1))  
    return x

def find_L1(d1, x, yard_to_foot=3):
    '''
    Рассчитывает длину первого участка пути спасателя.

    @param d1 (float): Расстояние от спасателя до кромки воды в ярдах.
    @param x (float):  Расстоние от спасателя до кромки воды под прямым углом.
    @param yard_to_foot (float): Коэффициент перевода ярдов в футы.
    @requires: Все параметры заданы и имеют правильные типы.
    @modifies: Ничего.
    @effects: Возвращает одно вещественное число.
    @returns: float: Длина первого участка пути L1.
    '''
    L1 = math.sqrt(x**2 + (yard_to_foot * d1)**2)    
    return L1

def find_L2(h, d2, x, yard_to_foot=3):
    '''
    Рассчитывает длину второго участка пути спасателя.

    @param h (float): Боковое смещение между спасателем и утопающим в ярдах.
    @param d2 (float): Расстояние от утопающего до берега в футах.
    @param x (float): Перемещённая координата вдоль пляжа.
    @param yard_to_foot (float): Коэффициент перевода ярдов в футы.
    @requires: Все параметры заданы и имеют правильные типы.
    @modifies: Ничего.
    @effects: Возвращает одно вещественное число.
    @returns: float: Длина второго участка пути L2.
    '''
    L2 = math.sqrt((yard_to_foot * h - x)**2 + d2**2)    
    return L2

def time_save(d1, d2, h, v_sand, n, theta1, mile_to_foot=5280):
    '''
    Рассчитывает время достижения спасателем утопающего.

    @param d1 (float): Расстояние от спасателя до кромки воды в ярдах.
    @param d2 (float): Расстояние от утопающего до берега в футах.
    @param h (float): Боковое смещение между спасателем и утопающим в ярдах.
    @param v_sand (float): Скорость движения спасателя по песку в милях/ч.
    @param n (float): Коэффициент замедления спасателя при движении в воде.
    @param theta1 (float): Угол направления движения спасателя по песку в градусах.
    @param mile_to_foot (float): Коэффициент перевода миль в футы.
    @requires: Все параметры заданы и имеют правильные типы.
    @modifies: Ничего.
    @effects: Возвращает одно вещественное число.
    @returns: float: Время достижения спасателем утопающего t.
    '''
    x = find_x(d1, theta1)
    L1 = find_L1(d1, x)
    L2 = find_L2(h, d2, x)
    t = (1 / (mile_to_foot * v_sand / 3600)) * (L1 + L2 * n)
    return t

def print_output(theta1, t):
    '''
    Выводит на экран результат расчёта времени достижения спасателем утопающего.

    @param theta1 (float): Направление движения спасателя по песку в градусах.
    @param t (float): Время достижения спасателем утопающего.
    @requires: Все параметры заданы и имеют правильные типы.
    @modifies: Ничего.
    @effects: Печать результата на экране.
    '''
    print(f'Если спасатель начнёт движение под углом theta1, равным {theta1:.1f} градусам, он достигнет утопающего через {t:.1f} секунды.')

d1, d2, h, v_sand, n, theta1 = take_input()
t = time_save(d1, d2, h, v_sand, n, theta1)
print_output(theta1, t)
    
# Тестирование
def test_find_x():
    expected = 30
    epsilon = 1.0e-1 
    t1 = 45
    actual = find_x(10, t1)
    if abs(actual - expected) > epsilon:
        print('Test failed')               # сообщение о неудаче теста
    else:
        print('Test passed')              

def test_find_L1():
    expected = 9.8
    epsilon = 1.0e-1 
    actual = find_L1(3, 4)
    if abs(actual - expected) > epsilon:
        print('Test failed')               
    else:
        print('Test passed')    

def test_find_L2():
    expected = 6
    epsilon = 1.0e-1 
    actual = find_L2(11, 6, 32)
    if abs(actual - expected) > epsilon:
        print('Test failed')               
    else:
        print('Test passed')    

def test_time_save():
    expected = 39.9                      
    epsilon = 1.0e-1                      
    t1 = 39.314                           
    actual = time_save(8, 10, 50, 5, 2, t1)  
    if abs(actual - expected) > epsilon:
        print('Test failed')               
    else:
        print('Test passed')    
        
test_find_x() 
test_find_L1()  
test_find_L2() 
test_time_save()
